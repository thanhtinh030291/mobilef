{"ast":null,"code":"import RemoteLogging from './RemoteLogging'; // error(message?: any, ...optionalParams: any[]): void;\n// info(message?: any, ...optionalParams: any[]): void;\n// log(message?: any, ...optionalParams: any[]): void;\n// warn(message?: any, ...optionalParams: any[]): void;\n// trace(message?: any, ...optionalParams: any[]): void;\n// debug(message?: any, ...optionalParams: any[]): void;\n// table(...data: any[]): void;\n// disableYellowBox: boolean;\n// ignoredYellowBox: string[];\n\n/**\n * Creates a console object that delegates calls to the specified underlying console and also sends\n * the messages to the development environment over a remote connection.\n */\n\nfunction createRemoteConsole(originalConsole) {\n  let groupDepth = 0;\n  const enhancedConsole = Object.create(originalConsole); // https://console.spec.whatwg.org/#debug\n  // Don't use a level below \"info\" because \"debug\" is intended for messages that shouldn't be shown\n  // to the developer\n\n  _defineConsoleLogMethod('debug', 'info'); // https://console.spec.whatwg.org/#log\n\n\n  _defineConsoleLogMethod('log', 'info'); // https://console.spec.whatwg.org/#info\n\n\n  _defineConsoleLogMethod('info', 'info'); // https://console.spec.whatwg.org/#warn\n\n\n  _defineConsoleLogMethod('warn', 'warn'); // https://console.spec.whatwg.org/#error\n\n\n  _defineConsoleLogMethod('error', 'error'); // https://console.spec.whatwg.org/#assert\n\n\n  enhancedConsole.assert = function assert(condition, ...data) {\n    if (originalConsole.assert) {\n      // @ts-ignore\n      originalConsole.assert(!!condition, ...data);\n    }\n\n    if (condition) {\n      return;\n    }\n\n    const assertionMessage = 'Assertion failed';\n\n    if (!data.length) {\n      data.push(assertionMessage);\n    } else {\n      if (typeof data[0] !== 'string') {\n        data.unshift(assertionMessage);\n      } else {\n        data[0] = `${assertionMessage}: ${data[0]}`;\n      }\n    }\n\n    _enqueueRemoteLog('error', {}, data);\n  }; // https://console.spec.whatwg.org/#group\n\n\n  enhancedConsole.group = function group(...data) {\n    if (originalConsole.group) {\n      // @ts-ignore\n      originalConsole.group(...data);\n    }\n\n    _enqueueRemoteLog('info', {}, data);\n\n    groupDepth++;\n  }; // https://console.spec.whatwg.org/#groupcollapsed\n\n\n  enhancedConsole.groupCollapsed = function groupCollapsed(...data) {\n    if (originalConsole.groupCollapsed) {\n      // @ts-ignore\n      originalConsole.groupCollapsed(...data);\n    }\n\n    _enqueueRemoteLog('info', {\n      groupCollapsed: true\n    }, data);\n\n    groupDepth++;\n  }; // https://console.spec.whatwg.org/#groupend\n\n\n  enhancedConsole.groupEnd = function groupEnd() {\n    if (originalConsole.groupEnd) {\n      originalConsole.groupEnd();\n    }\n\n    if (groupDepth > 0) {\n      groupDepth--;\n    }\n\n    _enqueueRemoteLog('info', {\n      shouldHide: true\n    }, []);\n  };\n  /**\n   * Defines a method in the `console.log()` family on the enhanced console\n   * instance\n   */\n\n\n  function _defineConsoleLogMethod(name, level) {\n    enhancedConsole[name] = function __expoConsoleLog(...data) {\n      let originalMethod = originalConsole[name];\n\n      if (typeof originalMethod === 'function') {\n        originalMethod.apply(originalConsole, data);\n      }\n\n      _enqueueRemoteLog(level, {}, data);\n    };\n  }\n  /**\n   * Schedules the given log entry to be sent remotely in a safe way that handles all errors. This\n   * function is responsible for error handling because the console methods are synchronous but\n   * sending log messages is asynchronous, so this code (instead of the console methods) needs to be\n   * responsible for asynchronous errors.\n   */\n\n\n  function _enqueueRemoteLog(level, additionalFields, data) {\n    RemoteLogging.enqueueRemoteLogAsync(level, {\n      groupDepth,\n      ...additionalFields\n    }, data).catch(error => {\n      originalConsole.error(`There was a problem sending log messages to your development environment`, error);\n    });\n  }\n\n  return enhancedConsole;\n}\n\nexport default {\n  createRemoteConsole\n};","map":{"version":3,"sources":["../../src/logs/RemoteConsole.ts"],"names":[],"mappings":"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","sourcesContent":["import RemoteLogging, { LogEntryFields, LogLevel } from './RemoteLogging';\n\ntype ReactConsole = typeof console;\n\n// error(message?: any, ...optionalParams: any[]): void;\n// info(message?: any, ...optionalParams: any[]): void;\n// log(message?: any, ...optionalParams: any[]): void;\n// warn(message?: any, ...optionalParams: any[]): void;\n// trace(message?: any, ...optionalParams: any[]): void;\n// debug(message?: any, ...optionalParams: any[]): void;\n// table(...data: any[]): void;\n// disableYellowBox: boolean;\n// ignoredYellowBox: string[];\n\n/**\n * Creates a console object that delegates calls to the specified underlying console and also sends\n * the messages to the development environment over a remote connection.\n */\nfunction createRemoteConsole(originalConsole: Console): Console {\n  let groupDepth = 0;\n\n  const enhancedConsole: typeof originalConsole = Object.create(originalConsole);\n\n  // https://console.spec.whatwg.org/#debug\n  // Don't use a level below \"info\" because \"debug\" is intended for messages that shouldn't be shown\n  // to the developer\n  _defineConsoleLogMethod('debug', 'info');\n\n  // https://console.spec.whatwg.org/#log\n  _defineConsoleLogMethod('log', 'info');\n\n  // https://console.spec.whatwg.org/#info\n  _defineConsoleLogMethod('info', 'info');\n\n  // https://console.spec.whatwg.org/#warn\n  _defineConsoleLogMethod('warn', 'warn');\n\n  // https://console.spec.whatwg.org/#error\n  _defineConsoleLogMethod('error', 'error');\n\n  // https://console.spec.whatwg.org/#assert\n  enhancedConsole.assert = function assert(condition: unknown, ...data: unknown[]): void {\n    if (originalConsole.assert) {\n      // @ts-ignore\n      originalConsole.assert(!!condition, ...data);\n    }\n\n    if (condition) {\n      return;\n    }\n\n    const assertionMessage = 'Assertion failed';\n    if (!data.length) {\n      data.push(assertionMessage);\n    } else {\n      if (typeof data[0] !== 'string') {\n        data.unshift(assertionMessage);\n      } else {\n        data[0] = `${assertionMessage}: ${data[0]}`;\n      }\n    }\n\n    _enqueueRemoteLog('error', {}, data);\n  };\n\n  // https://console.spec.whatwg.org/#group\n  enhancedConsole.group = function group(...data: unknown[]): void {\n    if (originalConsole.group) {\n      // @ts-ignore\n      originalConsole.group(...data);\n    }\n\n    _enqueueRemoteLog('info', {}, data);\n    groupDepth++;\n  };\n\n  // https://console.spec.whatwg.org/#groupcollapsed\n  enhancedConsole.groupCollapsed = function groupCollapsed(...data: unknown[]): void {\n    if (originalConsole.groupCollapsed) {\n      // @ts-ignore\n      originalConsole.groupCollapsed(...data);\n    }\n\n    _enqueueRemoteLog('info', { groupCollapsed: true }, data);\n    groupDepth++;\n  };\n\n  // https://console.spec.whatwg.org/#groupend\n  enhancedConsole.groupEnd = function groupEnd(): void {\n    if (originalConsole.groupEnd) {\n      originalConsole.groupEnd();\n    }\n\n    if (groupDepth > 0) {\n      groupDepth--;\n    }\n\n    _enqueueRemoteLog('info', { shouldHide: true }, []);\n  };\n\n  /**\n   * Defines a method in the `console.log()` family on the enhanced console\n   * instance\n   */\n  function _defineConsoleLogMethod(name: keyof typeof console, level: LogLevel): void {\n    enhancedConsole[name] = function __expoConsoleLog(...data: unknown[]): void {\n      let originalMethod = originalConsole[name];\n      if (typeof originalMethod === 'function') {\n        originalMethod.apply(originalConsole, data);\n      }\n\n      _enqueueRemoteLog(level, {}, data);\n    };\n  }\n\n  /**\n   * Schedules the given log entry to be sent remotely in a safe way that handles all errors. This\n   * function is responsible for error handling because the console methods are synchronous but\n   * sending log messages is asynchronous, so this code (instead of the console methods) needs to be\n   * responsible for asynchronous errors.\n   */\n  function _enqueueRemoteLog(\n    level: LogLevel,\n    additionalFields: LogEntryFields,\n    data: unknown[]\n  ): void {\n    RemoteLogging.enqueueRemoteLogAsync(level, { groupDepth, ...additionalFields }, data).catch(\n      error => {\n        originalConsole.error(\n          `There was a problem sending log messages to your development environment`,\n          error\n        );\n      }\n    );\n  }\n\n  return enhancedConsole;\n}\n\nexport default {\n  createRemoteConsole,\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}